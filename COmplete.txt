###------------------------------###   
### Author : Biswajit Biswas-----###     
###MCC, MCSA,MCTS, CCNA, SME,ITIL###   
###Email<bshwjt@gmail.com>-------###   
###------------------------------###   
###/////////..........\\\\\\\\\\\###   
###///////////.....\\\\\\\\\\\\\\### 
###Required PS Version 3 or Above###   
Function Get-NICConfig { 
$Prop = [ordered]@{} 
$ComputerName = Get-Content c:\computers.txt -ReadCount 0  
$ErrorActionPreference = "Stop"  
foreach ($computer in $ComputerName) 
  {  
 
Try { 
 
$Syntax = GWMI -class Win32_NetworkAdapterConfiguration -cn $computer | ? IpEnabled -EQ "True"  
$Prop.ComputerName = $Syntax.DNSHostName 
$IPV4 = $Syntax.IPAddress -join ',' 
$Prop."IPV4---IPV6" = $IPV4 -replace ","," --- " 
 
$Prop.Subnet = $Syntax.IPSubnet -join ',' 
$Prop.Mac = $Syntax.MACAddress 
 
 
New-Object PSObject -property $Prop  
}   
 
  Catch 
  { 
   
  Add-Content "$computer is not reachable" -path $env:USERPROFILE\Desktop\UnreachableHosts.txt 
  } 
 } 
} 
#$date = Get-Date 
$a = "<!--mce:0-->" 
Get-NICConfig | ConvertTo-HTML -head $a -body "<H2>NIC Configs</H2>" |  
Out-File $env:USERPROFILE\Desktop\NICConfigs.htm #HTML Output 
Invoke-Item $env:USERPROFILE\Desktop\NICConfigs.htm


---- 
Snaopshot

param([Parameter(Mandatory=$True)][string]$vCenter,[Parameter(Mandatory=$True)][string]$snapName,[Parameter(Mandatory=$True)][string]$snapDescription)
Connect-VIServer $VC5AU1
$TimeStamp = get-date -Format "yyyyMd_HHmmss"
foreach ($vm in gc .\VMList.txt){
Write-Output "Creating snapshot for $vm..."
Get-VM $vm | New-Snapshot -Name $snapName -Description $snapDescription -Verbose | Select-Object VM,Created,Name,Description,SizeMB,SizeGB,IsCurrent,ParentSnapshot,Children | Export-Csv -Path ".\CreateBulkSnapshots_Results_$TimeStamp.csv" -NoTypeInformation -Append

} 


---- Create 
param([Parameter(Mandatory=$True)][string]$vCenter,[Parameter(Mandatory=$True)][string]$snapName,[Parameter(Mandatory=$True)][string]$snapDescription)
Connect-VIServer $vCenter
$TimeStamp = get-date -Format "yyyyMd_HHmmss"
foreach ($vm in gc .\VMList.txt){
Write-Output "Creating snapshot for $vm..."
Get-VM $vm | New-Snapshot -Name $snapName -Description $snapDescription -Verbose | Select-Object VM,Created,Name,Description,SizeMB,SizeGB,IsCurrent,ParentSnapshot,Children | Export-Csv -Path ".\CreateBulkSnapshots_Results_$TimeStamp.csv" -NoTypeInformation -Append

} 


---

remove

param([Parameter(Mandatory=$True)][string]$vCenter,[Parameter(Mandatory=$True)][string]$snapshotName)
Connect-VIServer $vCenter
$TimeStamp = get-date -Format "yyyyMd_HHmmss"
foreach($VM in gc .\vmlist.txt) {
Write-Output "Removing snapshot for $VM with name matching $snapshotName..."
Get-vm $VM | Get-Snapshot | where {$_.Name -match $snapshotName} | Remove-Snapshot -confirm:$false -Verbose *>> .\RemoveBulkSnapshots_Results_$TimeStamp.txt

}

